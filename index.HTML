<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIMPE | Governo de Pernambuco</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script> 

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root {
            --azul-gov-principal: #002776;
            --amarelo-gov-detalhe: #FFD700;
            --cinza-texto: #333333;
            --cinza-fundo: #f4f4f4;
            --branco: #ffffff;
        }

        body { margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background-color: var(--cinza-fundo); color: var(--cinza-texto); line-height: 1.6; }
        
        .main-header { background-color: var(--branco); box-shadow: 0 2px 5px rgba(0,0,0,0.1); padding: 0 5%; position: sticky; top: 0; z-index: 1000; }
        .main-nav { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; height: 70px; }
        .logo a { text-decoration: none; display: flex; align-items: center; gap: 12px; }
        .logo img { height: 45px; filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0));}
        .logo .site-title { 
            color: var(--azul-gov-principal); 
            font-size: 1.4em; 
            font-weight: 800; 
            line-height: 1.2;
            font-family: 'Segoe UI', 'Arial Black', sans-serif;
            letter-spacing: 0.5px;
        }
        .logo .site-subtitle { 
            color: var(--cinza-texto); 
            font-size: 0.8em; 
            display: block;
            text-align: center;
        }
        .logo div {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .main-nav ul { list-style: none; margin: 0; padding: 0; display: flex; gap: 20px; }
        .main-nav a { text-decoration: none; color: var(--cinza-texto); font-weight: 600; padding: 10px; border-bottom: 2px solid transparent; transition: all 0.3s ease; }
        .main-nav a:hover, .main-nav a.active { color: var(--azul-gov-principal); border-bottom-color: var(--amarelo-gov-detalhe); }

        .hero-section { display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; height: 60vh; padding: 0 20px; background-color: #e9eef5; }
        .hero-section h1 { font-size: 2.8em; color: var(--azul-gov-principal); margin-bottom: 15px; }
        .hero-section p { font-size: 1.2em; max-width: 600px; margin-bottom: 30px; }
        .cta-button { display: inline-block; background-color: var(--azul-gov-principal); color: var(--branco); padding: 15px 30px; font-size: 1em; font-weight: bold; text-decoration: none; border-radius: 5px; transition: transform 0.2s ease, background-color 0.2s ease; }
        .cta-button:hover { background-color: #001a4d; transform: translateY(-3px); }
       
        .features-section { padding: 60px 5%; text-align: center; overflow: hidden; }
        .features-section h2 { font-size: 2.2em; color: var(--azul-gov-principal); margin-bottom: 40px; }
        .feature-card { background-color: var(--branco); border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 30px; height: 100%; display: flex; flex-direction: column; }
        .feature-card .icon {
            font-size: 3em; 
            color: var(--azul-gov-principal);
            margin-bottom: 10px; 
        }
        .feature-card h3 { font-size: 1.5em; margin: 20px 0 10px 0; }
        .feature-card p { font-size: 1em; margin-bottom: 25px; flex-grow: 1; }

      
        .features-section .swiper { padding: 20px 40px 80px 40px;; overflow: visible; }
        .swiper-slide { width: 320px; height: auto; transition: transform 0.4s ease, opacity 0.4s ease; opacity: 0.7; }
        .swiper-slide-active { transform: scale(1.1); opacity: 1; z-index: 10; }
        .swiper-slide:hover { transform: scale(1.15); opacity: 1; }
        .swiper-button-next, .swiper-button-prev { color: var(--azul-gov-principal); }
        .swiper-pagination-bullet {background: var(--azul-gov-principal); opacity: 0.3; }
        .swiper-pagination-bullet-active {opacity: 1; background: var(--azul-gov-principal); }
        .features-section .swiper .swiper-pagination { position: absolute; bottom: -40px !important; 
        }
      
        .main-footer { text-align: center; padding: 20px; margin-top: 40px; background-color: var(--branco); font-size: 0.9em; position: relative; height: 60px; }
        .main-footer .footer-content { display: flex; justify-content: center; align-items: center; height: 100%; }
        .main-footer img { height: 110px; width: auto; position: absolute; right: 5%; top: 50%; transform: translateY(-50%); }

        .main-footer p a {
        color: var(--cinza-texto);
        font-weight: 600;
        text-decoration: none;
        transition: color 0.2s;
        }
        .main-footer p a:hover {
        text-decoration: underline;
        color: var(--azul-gov-principal);
        }

        .presentation-section {
            background-color: var(--branco);
            padding: 60px 5%;
        }
        .presentation-content {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        .presentation-content h2 {
            font-size: 2.2em;
            color: var(--azul-gov-principal);
            margin-bottom: 20px;
        }
        .presentation-content p {
            font-size: 1.1em;
            line-height: 1.7;
            margin-bottom: 30px;
        }
        .presentation-content img {
            max-height: 250px; 
            width: auto; 
        }
        
    
        .pillars-section {
            background-color: var(--branco); 
            padding: 60px 5%;
        }
        .pillars-section h2 {
            text-align: center;
            font-size: 2.2em;
            color: var(--azul-gov-principal);
            margin-bottom: 40px;
        }
        .pillars-grid {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 0 auto;
        }
        .pillar-card {
            width: 300px;
            min-width: 280px; 
            text-align: center;
        }
        .pillar-card .icon {
            font-size: 3.5em;
        }
        .pillar-card h3 {
            font-size: 1.5em;
            margin: 15px 0 10px 0;
            color: var(--cinza-texto);
        }
        .pillar-card p {
            font-size: 1em;
            line-height: 1.6;
        }   

        .disabled-link {
            cursor: not-allowed; 
        }

        #logout-btn {
            cursor: pointer;
        }

        /* Estilo para o link da área administrativa no menu */
        .admin-menu-item {
            display: none;
        }

    </style>
</head>
<body>

    <header class="main-header">
        <nav class="main-nav">
            <div class="logo">
                <a href="/">
                    <img src="/assets/logo-header.png" alt="Logo do Governo de Pernambuco">
                    <div>
                        <span class="site-title">SIMPE</span>
                        <span class="site-subtitle">Portal da Transparência</span>
                    </div>
                </a>
            </div>
            <ul id="nav-links">
                <!-- Menu será carregado pelo global.js -->
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero-section">
            <h1>Plataforma de Análise de Sites</h1>
            <p>Ferramentas digitais para otimização e verificação de integridade para portais do Governo de Pernambuco.</p>
            <a href="/scanner" class="cta-button">Acessar o Scanner de Links</a>
        </section>

        <section class="presentation-section" data-aos="fade-up">
            <div class="presentation-content">
                <h2>Uma Iniciativa para a Transparência</h2>
                <p>Esta plataforma é uma ferramenta desenvolvida pela Secretaria da Controladoria-Geral do Estado (SCGE) para auxiliar os órgãos e entidades do Poder Executivo Estadual a aprimorar a transparência de seus portais, em conformidade com a legislação e as boas práticas de acesso à informação.</p>
                <img src="/assets/simpe.png" alt="Logo do SIMPE">
            </div>
        </section>

        <section class="features-section" style="
            background-image: url('/assets/bandeira-pe.jpg');
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
            position: relative;
        ">
            <div class="section-overlay" style="
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(255, 255, 255, 0.8); 
                z-index: 1;
            "></div>

            <div class="container" style="position: relative; z-index: 2;">
                
                <h2 data-aos="fade-up">Nossas Ferramentas</h2>
                
                <div class="swiper" data-aos="fade-up" data-aos-delay="200">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide">
                            <div class="feature-card">
                                <div class="icon"><i class="fas fa-search"></i></div>
                                <h3>Scanner de Links</h3>
                                <p>Uma ferramenta completa para verificar todos os links de um site, identificar links quebrados e garantir a integridade do seu portal.</p>
                                <a href="/scanner" class="cta-button">Utilizar Ferramenta</a>
                            </div>
                        </div>
                        
                        <div class="swiper-slide">
                            <div class="feature-card">
                                <div class="icon"><i class="fas fa-file-alt"></i></div>
                                <h3>Autoavaliação de Transparência</h3>
                                <p>Preencha o checklist de transparência ativa de forma inteligente, com pré-validação automática de requisitos.</p>
                                <a id="form-card-link" href="#" class="cta-button">Iniciar Avaliação</a>
                            </div>
                        </div>
                        
                        <div class="swiper-slide">
                            <div class="feature-card">
                                <div class="icon"><i class="fas fa-chart-line"></i></div>
                                <h3>Consultar Nota Final</h3>
                                <p>Consulte a nota final das suas avaliações já concluídas e acesse os relatórios detalhados de desempenho.</p>
                                <a href="#" id="nota-final-link" class="cta-button">Consultar Nota</a>
                            </div>
                        </div>
                        
                        <div class="swiper-slide">
                            <div class="feature-card">
                                <div class="icon"><i class="fas fa-universal-access"></i></div>
                                <h3>Auditoria de Acessibilidade (Em Breve)</h3>
                                <p>Verifique se o seu site atende às diretrizes de acessibilidade, garantindo que todos os cidadãos possam navegar com facilidade.</p>
                                <a href="#" class="cta-button" style="background-color: grey; cursor: not-allowed;">Indisponível</a>
                            </div>
                        </div>
                    </div>
                    <div class="swiper-pagination"></div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-button-next"></div>
                </div>
                
            </div>
        </section>

        <section class="pillars-section">
            <div data-aos="fade-up">
                <h2>Compromisso com a Transparência Pública</h2>
                <div class="pillars-grid">
                    <div class="pillar-card">
                        <div class="icon"><i class="fas fa-shield-alt"></i></div>
                        <h3>Integridade</h3>
                        <p>Garanta que todos os links do seu portal estejam funcionando perfeitamente, evitando páginas de erro e melhorando a experiência do cidadão.</p>
                    </div>
                    <div class="pillar-card">
                        <div class="icon"><i class="fas fa-robot"></i></div>
                        <h3>Automação</h3>
                        <p>Economize horas de trabalho manual com a pré-validação automática de requisitos do Guia de Transparência Ativa.</p>
                    </div>
                    <div class="pillar-card">
                        <div class="icon"><i class="fas fa-table"></i></div>
                        <h3>Dados Estruturados</h3>
                        <p>Tenha uma visão clara e detalhada do status de conformidade do seu site através de relatórios e de uma área de gestão centralizada.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="main-footer">
        <div class="footer-content">
            <p>&copy; 2025 Governo de Pernambuco. Todos os direitos reservados. <a id="admin-footer-link" href="/admin" style="display: none;">Área Administrativa</a>
            <img src="/assets/logo-footer.png" alt="Logo da Controladoria-Geral do Estado de Pernambuco">
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // Verificar autenticação e carregar menu
            const authToken = localStorage.getItem('authToken');
            const navLinks = document.getElementById('nav-links');
            const formCardLink = document.getElementById('form-card-link');
            const notaFinalLink = document.getElementById('nota-final-link');
            const adminFooterLink = document.getElementById('admin-footer-link');

            // Função para verificar se tem avaliação finalizada
            async function verificarNotaFinal() {
                try {
                    const response = await fetch('/api/my-avaliacoes', {
                        headers: {
                            'Authorization': `Bearer ${authToken}`,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const avaliacoes = await response.json();
                        const avaliacaoFinalizada = avaliacoes.find(av => av.status === 'FINALIZADA');
                        
                        if (avaliacaoFinalizada) {
                            // Redireciona para a nota final
                            window.location.href = `/nota-final/${avaliacaoFinalizada.id}`;
                        } else {
                            Swal.fire({
                                icon: 'info',
                                iconColor: 'var(--azul-gov-principal)',
                                title: 'Nenhuma nota final disponível',
                                text: 'Você ainda não possui avaliações finalizadas com nota disponível.',
                                confirmButtonColor: 'var(--azul-gov-principal)'
                            });
                        }
                    } else {
                        throw new Error('Erro ao buscar avaliações');
                    }
                } catch (error) {
                    console.error('Erro ao verificar nota final:', error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Erro',
                        text: 'Não foi possível verificar suas avaliações.',
                        confirmButtonColor: 'var(--azul-gov-principal)'
                    });
                }
            }

            // Configurar link da nota final
            if (notaFinalLink) {
                notaFinalLink.addEventListener('click', async (e) => {
                    e.preventDefault();
                    
                    if (!authToken) {
                        Swal.fire({
                            icon: 'warning',
                            title: 'Login necessário',
                            text: 'Faça login para consultar suas notas.',
                            confirmButtonColor: 'var(--azul-gov-principal)'
                        });
                        return;
                    }

                    await verificarNotaFinal();
                });
            }

            // Configurar link do formulário
            if (formCardLink) {
                formCardLink.addEventListener('click', (e) => {
                    if (!authToken) {
                        e.preventDefault();
                        Swal.fire({
                            icon: 'warning',
                            title: 'Login necessário',
                            text: 'Faça login para acessar o formulário de avaliação.',
                            confirmButtonColor: 'var(--azul-gov-principal)'
                        });
                    } else {
                        formCardLink.href = '/formulario';
                    }
                });
            }

            // Carregar menu de navegação
            if (authToken) {
                try {
                    const response = await fetch('/verify-token', {
                        headers: {
                            'Authorization': `Bearer ${authToken}`,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const userData = await response.json();
                        
                        // Menu para usuários logados
                        navLinks.innerHTML = `
                            <li><a href="/dashboard" class="active">Minha Área</a></li>
                            ${userData.user.role === 'ADMIN' ? 
                                '<li><a href="/admin">Área Administrativa</a></li>' : 
                                ''}
                            <li><a href="#" id="logout-btn">Sair</a></li>
                        `;

                        // Mostrar link administrativo no footer apenas para admin
                        if (userData.user.role === 'ADMIN') {
                            adminFooterLink.style.display = 'inline';
                        }

                        // Configurar logout
                        document.getElementById('logout-btn').addEventListener('click', (e) => {
                            e.preventDefault();
                            localStorage.removeItem('authToken');
                            window.location.href = '/';
                        });

                    } else {
                        throw new Error('Token inválido');
                    }
                } catch (error) {
                    // Token inválido, mostrar menu público
                    navLinks.innerHTML = `
                        <li><a href="/login">Entrar</a></li>
                    `;
                    localStorage.removeItem('authToken');
                }
            } else {
                // Usuário não logado
                navLinks.innerHTML = `
                    <li><a href="/login">Entrar</a></li>
                `;
            }

            // Configurações gerais
            document.querySelectorAll('.disabled-link').forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault(); 
                    alert('Indisponível no momento');
                });
            });
            
            AOS.init({
                duration: 800,
                once: true, 
            });
            
            const swiper = new Swiper('.swiper', {
                effect: 'slide',
                slidesPerView: 1, 
                spaceBetween: 10,
                loop: false,
                centeredSlides: true,
                grabCursor: true,
                autoplay: {
                delay: 4000,
                disableOnInteraction: false,
                pauseOnMouseEnter: true,
                },
                breakpoints: {
                    768: {
                        slidesPerView: 2,
                        spaceBetween: 20
                    },
                    1024: {
                        slidesPerView: 3,
                        spaceBetween: 30
                    }
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
            });
            
        }); 
    </script>

    <script src="/global.js"></script>

</body>
</html>